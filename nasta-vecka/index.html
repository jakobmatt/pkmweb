<!DOCTYPE html>
<html lang='sv'>
    <!-- Example: https://molndal.pingst.se/nasta-vecka/?dagar=10&plats=0&text=0 -->

	<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		
		<link href='./packages/core/main.css' rel='stylesheet' />
        <link href='./packages/bootstrap/main.css' rel='stylesheet' />
		<link href='./packages/list/main.css' rel='stylesheet' />

		<script src='./packages/core/main.js'></script>
        <script src='./packages/bootstrap/main.js'></script>
		<script src='./packages/core/locales-all.js'></script>
		<script src='./packages/list/main.js'></script>
		<script src='./packages/google-calendar/main.js'></script>
        <script src='./examples/js/theme-chooser.js'></script>

		<script>

        function getUrlVars() {
            var vars = {};
            var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
                vars[key] = value;
                });
            return vars;
        }

        function getUrlParam(parameter, defaultvalue){
            var urlparameter = defaultvalue;
            if(window.location.href.indexOf(parameter) > -1) {
                urlparameter = getUrlVars()[parameter];
                //document.write("value of " + parameter + " is " + urlparameter);
            }
            return urlparameter;
        }

		document.addEventListener('DOMContentLoaded', function() {
            var initialLocaleCode = 'sv';
			var calendarEl = document.getElementById('calendar');
			var calendar;
            initThemeChooser({
        
                init: function(themeSystem) {
        			calendar = new FullCalendar.Calendar(calendarEl, {
                        // an array of strings! [ 'dayGrid', 'timeGrid', 'list' ]
                        plugins: [ 'bootstrap', 'list', 'googleCalendar' ],
        
                        themeSystem: 'bootstrap',
            			displayEventTime: true, // show the time column in list view
            			displayEventEnd: false, // don't display event end time
                        eventRender: function(info) {
                            //console.log(info.el.querySelector('.fc-list-item-title').innerHTML);
                            var titleObj = info.el.querySelector('.fc-title, .fc-list-item-title');
                            titleObj.innerHTML = '<a href=' + info.event.url + '>' + info.event.title + '</a>';
                            if (typeof info.event.extendedProps.location !== "undefined")
                            {
                                if (parseInt(getUrlParam('plats', '1')) == 1)
                                {
                                    titleObj.innerHTML += ', ' + info.event.extendedProps.location + '<br/>';
                                    //console.log(info.event.extendedProps.location);
                                }
                            }
                            if (typeof info.event.extendedProps.description !== "undefined")
                            {
                                if (parseInt(getUrlParam('text', '0')) == 1)
                                {
                                    titleObj.innerHTML += info.event.extendedProps.description; 
                                    //console.log(info.event.extendedProps.description);
                                }
                            }
                            //console.log(titleObj.innerHTML);
                        },
                        header: { 
                            left: '', 
                            center: 'title', 
                            right: '' //'prev,next today'
                        },
            			height: "parent",
        
            			// To make your own Google API key, follow the directions here:
            			// http://fullcalendar.io/docs/google_calendar/
            			googleCalendarApiKey: 'AIzaSyBrT1Kwv8jumSOpOSr8NcQ2bEHi49DYVNU',
        
            			// Calendar - Elvanto - event rensad 
            			events: '1qv8joj1hnumb2guqjpofoj3f0@group.calendar.google.com',
                        //eventTextColor: '#ffffff',
            			eventClick: function(arg) {
            				// opens events in a popup window
            			//	window.open(arg.event.url, 'google-calendar-event', 'width=700,height=600');
            
            				arg.jsEvent.preventDefault() // don't navigate in main tab
            			},
                        defaultView: 'list',
                        duration: { days: parseInt(getUrlParam('dagar', '8')) }, // default 8 days
                        buttonIcons: true, // show the prev/next text
                        locale: initialLocaleCode,
                        navLinks: false, // can click day/week names to navigate views
                        editable: false,
            			loading: function(bool) {
            				document.getElementById('loading').style.display =
            				  bool ? 'block' : 'none';
            			}
            		});

                    //calendar.changeView('listWeek');
                    //calendar.gotoDate( new Date() );
                    //calendar.setOption('themeSystem', 'darkly');
            		calendar.render();
                },
            
                change: function(themeSystem) {
                    calendar.setOption('themeSystem', themeSystem);
                }
            });
		});

		</script>
		<style>

		  body {
			margin: 40px 10px;
			padding: 0;
			font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
			font-size: 14px;
			background-color: #555555;
		  }
		  
		  h1 {
		    color: #ffffff;
		  }

          #top,
          #calendar.fc-unthemed {
            font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
          }

          #top .selector {
            display: inline-block;
            margin-right: 10px;
          }

		  #loading {
			display: none;
			position: absolute;
			top: 10px;
			right: 10px;
		  }

		  #calendar {
			max-width: 900px;
			margin: 40px auto;
			padding: 0 10px;
		  }
		  
		</style>
	</head>
	<body>
	    <div id='loading'>uppdaterar...
            <div id='theme-system-selector' class='selector' style='display:none'>
                <select>
                    <option value='bootstrap' selected>Bootstrap 4</option>
                    <option value='standard'>unthemed</option>
                </select>
            </div>
            <div data-theme-system="bootstrap" class='selector' style='display:none'>
                <select>
                    <option value='cyborg'>Cyborg</option>
                    <option value='darkly' selected>Darkly</option>
                </select>
            </div>
	    </div>


        <center>
            <!--<h1>N&auml;sta vecka</h1>-->
            <div id='calendar'></div>
        </center>

	</body>
</html>
